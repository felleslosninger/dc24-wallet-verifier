<!DOCTYPE html>
<html lang="no">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" media="all" th:href="@{/css/qr.css}"/>
	<script th:src="@{/js/qr.js}" defer></script>
	<script th:inLine="javascript">

		document.addEventListener("DOMContentLoaded", function() {
			pollGetRequest();
		});

		function pollGetRequest() {
			var tx_code = /*[[${presentation_id}]]*/ 'defaultCode';
			console.log(tx_code);
			fetch('https://verifier-backend.eudiw.dev/ui/presentations/' + tx_code)
				.then(response => {
					if (response.status === 200) {
						window.location.href = '/presentation-view';
						return response.json();
					} else {
						throw new Error('Response not 200');
					}
				})
				.catch(error => {
					console.log(error);
					setTimeout(pollGetRequest, 2000); // Poll every 2 seconds on error
				});
		}
	</script>
	<title>qrCode</title>
</head>
<body>
	<header>
        <button class="dark-mode-toggle" aria-pressed="false" aria-label="Aktiver dark mode for bedre lesbarhet">Dark Mode</button>
        <nav>
            <ul>
                <li><a href="javascript:history.back()" class="back-button">Tilbake</a></li>
            </ul>		
        </nav>
	</header>
	<main>
		<section class="container">
            <h1>Scan QR-kode</h1>
			<h1 th:text="${transactionToken}"></h1>
            <h4><img th:src="${qrCode}"></img></h4>
			<div id="loading-dot"></div>
		</section>
	</main>
    <footer>
        <p>Â© 2024 Digdircamp.</p>
    </footer>
</body>
</html>